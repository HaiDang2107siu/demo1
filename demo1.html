!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Happy New Year 2026</title>
<style>
html,body{
  margin:0;
  overflow:hidden;
  background:black;
  font-family:Arial, Helvetica, sans-serif;
}
canvas{position:fixed;inset:0}
#start{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:64px;
  color:#ffd700;
  cursor:pointer;
  background:black;
  z-index:10;
}
</style>
</head>
<body>

<div id="start">BẮT ĐẦU</div>
<canvas id="c"></canvas>

<script>
const canvas=c,ctx=canvas.getContext("2d");
resize();onresize=resize;
function resize(){canvas.width=innerWidth;canvas.height=innerHeight}

let rockets=[],particles=[],texts=[];
let started=false,startTime=0,finalDone=false;
let fireRate=1;

const colors=["#ff4444","#ffd700","#66aaff","#00ff99","#bb66ff"];

/* ===== ROCKET ===== */
class Rocket{
 constructor(){
  this.x=Math.random()*canvas.width;
  this.y=canvas.height;
  this.vy=-9-Math.random()*4;
  this.explodeY=canvas.height*0.25+Math.random()*canvas.height*0.25;
 }
 update(){
  this.y+=this.vy;
  if(this.y<=this.explodeY){
   explode(this.x,this.y);
   return false;
  }
  return true;
 }
 draw(){
  ctx.fillStyle="white";
  ctx.fillRect(this.x,this.y,2,8);
 }
}

/* ===== PARTICLE ===== */
class Particle{
 constructor(x,y,vx,vy,color,life,freeze=0){
  this.x=x;this.y=y;
  this.vx=vx;this.vy=vy;
  this.color=color;
  this.life=life;
  this.freeze=freeze;
 }
 update(){
  if(this.freeze>0){this.freeze--;return;}
  this.x+=this.vx;
  this.y+=this.vy;
  this.vy+=0.04;
  this.life--;
 }
 draw(){
  ctx.globalAlpha=Math.min(this.life/160,0.9);
  ctx.fillStyle=this.color;
  ctx.fillRect(this.x,this.y,2,2);
  ctx.globalAlpha=1;
 }
}

/* ===== FIREWORK SHAPES ===== */
function sphere(x,y,c){
 for(let i=0;i<200;i++){
  const a=Math.random()*Math.PI*2;
  const r=2+Math.random()*3;
  particles.push(new Particle(x,y,Math.cos(a)*r,Math.sin(a)*r,c,120));
 }
}

function heart(x,y){
 for(let t=0;t<Math.PI*2;t+=0.12){
  const r=14*(1-Math.sin(t));
  particles.push(new Particle(
   x+r*Math.cos(t),
   y-r*Math.sin(t),
   (Math.random()-0.5),
   (Math.random()-0.5),
   "#ff4466",120
  ));
 }
}

function star(x,y,c){
 for(let i=0;i<5;i++){
  const a=i*2*Math.PI/5;
  for(let r=0;r<18;r++){
   particles.push(new Particle(
    x,y,
    Math.cos(a)*r*0.35,
    Math.sin(a)*r*0.35,
    c,100
   ));
  }
 }
}

function willow(x,y,c){
 for(let i=0;i<120;i++){
  particles.push(new Particle(
   x,y,
   (Math.random()-0.5)*1.2,
   Math.random()*3,
   c,140
  ));
 }
}

function volcano(x){
 for(let i=0;i<140;i++){
  particles.push(new Particle(
   x,canvas.height,
   (Math.random()-0.5)*1.2,
   -Math.random()*6-4,
   colors[Math.floor(Math.random()*colors.length)],
   140
  ));
 }
}

function comet(){
 const y=Math.random()*canvas.height*0.4;
 for(let i=0;i<80;i++){
  particles.push(new Particle(
   -50,y,
   6+Math.random()*2,
   (Math.random()-0.5)*0.2,
   "white",120
  ));
 }
}

function explode(x,y){
 const c=colors[Math.floor(Math.random()*colors.length)];
 const t=Math.floor(Math.random()*6);
 if(t===0) sphere(x,y,c);
 if(t===1) heart(x,y);
 if(t===2) star(x,y,c);
 if(t===3) willow(x,y,c);
 if(t===4) volcano(x);
 if(t===5) comet();
}

/* ===== NEON TEXT (NGẮN) ===== */
function neonText(txt){
 texts.push({txt,life:60});
}

/* ===== PARTICLE TEXT FINAL ===== */
function particleText(txt){
 const off=document.createElement("canvas");
 off.width=1200;
 off.height=400;
 const o=off.getContext("2d");
 o.clearRect(0,0,off.width,off.height);
 o.fillStyle="white";
 o.font="bold 90px Arial";
 o.textAlign="center";
 o.textBaseline="middle";
 o.fillText(txt,off.width/2,off.height/2);

 const img=o.getImageData(0,0,off.width,off.height);
 for(let y=0;y<img.height;y+=3){
  for(let x=0;x<img.width;x+=3){
   if(img.data[(y*img.width+x)*4]>0){
    particles.push(new Particle(
     x+canvas.width/2-off.width/2,
     y+canvas.height/2-off.height/2,
     (Math.random()-0.5)*1.2,
     (Math.random()-0.5)*1.2,
     "#ffd700",
     180,
     180   // đứng yên 3s
    ));
   }
  }
 }
}

/* ===== START + COUNTDOWN ===== */
start.onclick=()=>{
 start.style.display="none";
 countdown(3);
};

function countdown(n){
 if(n<0){
  started=true;
  startTime=performance.now();
  return;
 }
 ctx.clearRect(0,0,canvas.width,canvas.height);
 ctx.fillStyle="#ffd700";
 ctx.font="bold 180px Arial";
 ctx.textAlign="center";
 ctx.fillText(n,canvas.width/2,canvas.height/2);
 setTimeout(()=>countdown(n-1),1000);
}

/* ===== LOOP ===== */
function loop(t){
 ctx.fillStyle="rgba(0,0,0,0.25)";
 ctx.fillRect(0,0,canvas.width,canvas.height);

 if(started){
  const sec=(t-startTime)/1000;

  fireRate=sec>20?3:sec>10?2:1;
  if(Math.random()<0.05*fireRate) rockets.push(new Rocket());

  if(sec>10 && sec<11) neonText("Vạn sự như ý");
  if(sec>18 && sec<19) neonText("An khang thịnh vượng");
  if(sec>24 && sec<25) neonText("Tấn tài tấn lộc");

  if(sec>27 && !finalDone){
   finalDone=true;
   particleText("Happy New Year 2026");
  }
 }

 rockets=rockets.filter(r=>{r.draw();return r.update()});
 particles=particles.filter(p=>{p.update();p.draw();return p.life>0});

 texts=texts.filter(t=>{
  ctx.fillStyle="rgba(255,215,0,0.85)";
  ctx.shadowColor="rgba(255,215,0,0.6)";
  ctx.shadowBlur=10;
  ctx.font="bold 64px Arial";
  ctx.textAlign="center";
  ctx.fillText(t.txt,canvas.width/2,200);
  ctx.shadowBlur=0;
  return --t.life>0;
 });

 requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
